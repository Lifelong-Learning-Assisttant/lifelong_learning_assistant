<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="634px" preserveAspectRatio="none" style="width:1460px;height:634px;background:#FFFFFF;" version="1.1" viewBox="0 0 1460 634" width="1460px" zoomAndPan="magnify"><title>&#1047;&#1072;&#1075;&#1088;&#1091;&#1079;&#1082;&#1072; &#1080; &#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1072; &#1082;&#1085;&#1080;&#1075;&#1080;</title><defs/><g><text fill="#000000" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="359.541" x="553.749" y="35.4209">&#1047;&#1072;&#1075;&#1088;&#1091;&#1079;&#1082;&#1072; &#1080; &#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1072; &#1082;&#1085;&#1080;&#1075;&#1080;</text><rect fill="#FFFFFF" height="148.4688" style="stroke:#000000;stroke-width:1;" width="576.2896" x="876.7495" y="375.1016"/><rect fill="#FFFFFF" height="43.9375" style="stroke:none;stroke-width:1;" width="576.2896" x="876.7495" y="479.6328"/><g><title>............</title><rect fill="#000000" fill-opacity="0.00000" height="515.9297" width="8" x="74.5498" y="82.9063"/><line style="stroke:#000000;stroke-width:1;" x1="78" x2="78" y1="82.9063" y2="598.8359"/></g><g><title>Web UI</title><rect fill="#000000" fill-opacity="0.00000" height="515.9297" width="8" x="216.3306" y="82.9063"/><line style="stroke:#000000;stroke-width:1;" x1="220.2461" x2="220.2461" y1="82.9063" y2="598.8359"/></g><g><title>API Gateway</title><rect fill="#000000" fill-opacity="0.00000" height="515.9297" width="8" x="387.6597" y="82.9063"/><line style="stroke:#000000;stroke-width:1;" x1="391.438" x2="391.438" y1="82.9063" y2="598.8359"/></g><g><title>Data Storage</title><rect fill="#000000" fill-opacity="0.00000" height="515.9297" width="8" x="522.2085" y="82.9063"/><line style="stroke:#000000;stroke-width:1;" x1="525.8813" x2="525.8813" y1="82.9063" y2="598.8359"/></g><g><title>PostgreSQL</title><rect fill="#000000" fill-opacity="0.00000" height="515.9297" width="8" x="652.9121" y="82.9063"/><line style="stroke:#000000;stroke-width:1;" x1="656.5356" x2="656.5356" y1="82.9063" y2="598.8359"/></g><g><title>Task Queue</title><rect fill="#000000" fill-opacity="0.00000" height="515.9297" width="8" x="778.7759" y="82.9063"/><line style="stroke:#000000;stroke-width:1;" x1="782.2886" x2="782.2886" y1="82.9063" y2="598.8359"/></g><g><title>Worker</title><rect fill="#000000" fill-opacity="0.00000" height="515.9297" width="8" x="925.0698" y="82.9063"/><line style="stroke:#000000;stroke-width:1;" x1="928.7495" x2="928.7495" y1="82.9063" y2="598.8359"/></g><g><title>Embedding Service</title><rect fill="#000000" fill-opacity="0.00000" height="515.9297" width="8" x="1103.21" y="82.9063"/><line style="stroke:#000000;stroke-width:1;" x1="1106.4111" x2="1106.4111" y1="82.9063" y2="598.8359"/></g><g><title>Vector DB</title><rect fill="#000000" fill-opacity="0.00000" height="515.9297" width="8" x="1250.2754" y="82.9063"/><line style="stroke:#000000;stroke-width:1;" x1="1254.0088" x2="1254.0088" y1="82.9063" y2="598.8359"/></g><g><title>Elasticsearch</title><rect fill="#000000" fill-opacity="0.00000" height="515.9297" width="8" x="1375.7905" y="82.9063"/><line style="stroke:#000000;stroke-width:1;" x1="1379.542" x2="1379.542" y1="82.9063" y2="598.8359"/></g><g class="participant participant-head" data-participant="U"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="117.0996" x="20" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="103.0996" x="27" y="71.6045">&#1055;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;</text></g><g class="participant participant-tail" data-participant="U"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="117.0996" x="20" y="597.8359"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="103.0996" x="27" y="617.8311">&#1055;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;</text></g><g class="participant participant-head" data-participant="UI"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="64.1689" x="188.2461" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="50.1689" x="195.2461" y="71.6045">Web UI</text></g><g class="participant participant-tail" data-participant="UI"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="64.1689" x="188.2461" y="597.8359"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="50.1689" x="195.2461" y="617.8311">Web UI</text></g><g class="participant participant-head" data-participant="API"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="102.4434" x="340.438" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="88.4434" x="347.438" y="71.6045">API Gateway</text></g><g class="participant participant-tail" data-participant="API"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="102.4434" x="340.438" y="597.8359"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="88.4434" x="347.438" y="617.8311">API Gateway</text></g><g class="participant participant-head" data-participant="FS"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="106.6543" x="472.8813" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="92.6543" x="479.8813" y="71.6045">Data Storage</text></g><g class="participant participant-tail" data-participant="FS"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="106.6543" x="472.8813" y="597.8359"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="92.6543" x="479.8813" y="617.8311">Data Storage</text></g><g class="participant participant-head" data-participant="DB"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="94.7529" x="609.5356" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="80.7529" x="616.5356" y="71.6045">PostgreSQL</text></g><g class="participant participant-tail" data-participant="DB"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="94.7529" x="609.5356" y="597.8359"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="80.7529" x="616.5356" y="617.8311">PostgreSQL</text></g><g class="participant participant-head" data-participant="MQ"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="96.9746" x="734.2886" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="82.9746" x="741.2886" y="71.6045">Task Queue</text></g><g class="participant participant-tail" data-participant="MQ"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="96.9746" x="734.2886" y="597.8359"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="82.9746" x="741.2886" y="617.8311">Task Queue</text></g><g class="participant participant-head" data-participant="Worker"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="64.6406" x="896.7495" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="50.6406" x="903.7495" y="71.6045">Worker</text></g><g class="participant participant-tail" data-participant="Worker"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="64.6406" x="896.7495" y="597.8359"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="50.6406" x="903.7495" y="617.8311">Worker</text></g><g class="participant participant-head" data-participant="EMB"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="149.5977" x="1032.4111" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="135.5977" x="1039.4111" y="71.6045">Embedding Service</text></g><g class="participant participant-tail" data-participant="EMB"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="149.5977" x="1032.4111" y="597.8359"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="135.5977" x="1039.4111" y="617.8311">Embedding Service</text></g><g class="participant participant-head" data-participant="VDB"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="84.5332" x="1212.0088" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="70.5332" x="1219.0088" y="71.6045">Vector DB</text></g><g class="participant participant-tail" data-participant="VDB"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="84.5332" x="1212.0088" y="597.8359"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="70.5332" x="1219.0088" y="617.8311">Vector DB</text></g><g class="participant participant-head" data-participant="ES"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="106.4971" x="1326.542" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="92.4971" x="1333.542" y="71.6045">Elasticsearch</text></g><g class="participant participant-tail" data-participant="ES"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="106.4971" x="1326.542" y="597.8359"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="92.4971" x="1333.542" y="617.8311">Elasticsearch</text></g><g class="message" data-participant-1="U" data-participant-2="UI"><polygon fill="#000000" points="208.3306,110.0391,218.3306,114.0391,208.3306,118.0391,212.3306,114.0391" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="78.5498" x2="214.3306" y1="114.0391" y2="114.0391"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="117.7808" x="85.5498" y="108.9731">&#1047;&#1072;&#1075;&#1088;&#1091;&#1078;&#1072;&#1077;&#1090; &#1082;&#1085;&#1080;&#1075;&#1091;</text></g><g class="message" data-participant-1="UI" data-participant-2="API"><polygon fill="#000000" points="379.6597,139.1719,389.6597,143.1719,379.6597,147.1719,383.6597,143.1719" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="220.3306" x2="385.6597" y1="143.1719" y2="143.1719"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="147.3291" x="227.3306" y="138.106">POST /api/book/upload</text></g><g class="message" data-participant-1="API" data-participant-2="FS"><polygon fill="#000000" points="514.2085,168.3047,524.2085,172.3047,514.2085,176.3047,518.2085,172.3047" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="391.6597" x2="520.2085" y1="172.3047" y2="172.3047"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="89.9082" x="398.6597" y="167.2388">store_raw_file</text></g><g class="message" data-participant-1="API" data-participant-2="DB"><polygon fill="#000000" points="644.9121,197.4375,654.9121,201.4375,644.9121,205.4375,648.9121,201.4375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="391.6597" x2="650.9121" y1="201.4375" y2="201.4375"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="201.5381" x="398.6597" y="196.3716">create_record(status: pending)</text></g><g class="message" data-participant-1="API" data-participant-2="MQ"><polygon fill="#000000" points="770.7759,226.5703,780.7759,230.5703,770.7759,234.5703,774.7759,230.5703" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="391.6597" x2="776.7759" y1="230.5703" y2="230.5703"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="155.5366" x="398.6597" y="225.5044">enqueue(process_book)</text></g><g class="message" data-participant-1="API" data-participant-2="UI"><polygon fill="#000000" points="231.3306,255.7031,221.3306,259.7031,231.3306,263.7031,227.3306,259.7031" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="225.3306" x2="390.6597" y1="259.7031" y2="259.7031"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="91.2158" x="237.3306" y="254.6372">202 {task_id}</text></g><g class="message" data-participant-1="MQ" data-participant-2="Worker"><polygon fill="#000000" points="917.0698,284.8359,927.0698,288.8359,917.0698,292.8359,921.0698,288.8359" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="782.7759" x2="923.0698" y1="288.8359" y2="288.8359"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="122.2939" x="789.7759" y="283.77">process_book_task</text></g><g class="message" data-participant-1="Worker" data-participant-2="FS"><polygon fill="#000000" points="537.2085,313.9688,527.2085,317.9688,537.2085,321.9688,533.2085,317.9688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="531.2085" x2="928.0698" y1="317.9688" y2="317.9688"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="55.8594" x="543.2085" y="312.9028">read_file</text></g><g class="message" data-participant-1="Worker" data-participant-2="Worker"><line style="stroke:#000000;stroke-width:1;" x1="929.0698" x2="971.0698" y1="347.1016" y2="347.1016"/><line style="stroke:#000000;stroke-width:1;" x1="971.0698" x2="971.0698" y1="347.1016" y2="360.1016"/><line style="stroke:#000000;stroke-width:1;" x1="930.0698" x2="971.0698" y1="360.1016" y2="360.1016"/><polygon fill="#000000" points="940.0698,356.1016,930.0698,360.1016,940.0698,364.1016,936.0698,360.1016" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="126.5151" x="936.0698" y="342.0356">parse &amp; chunk_text</text></g><path d="M876.7495,375.1016 L946.2388,375.1016 L946.2388,382.2344 L936.2388,392.2344 L876.7495,392.2344 L876.7495,375.1016" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="148.4688" style="stroke:#000000;stroke-width:1;" width="576.2896" x="876.7495" y="375.1016"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24.4893" x="891.7495" y="388.1685">par</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="165.6284" x="961.2388" y="387.312">[&#1043;&#1077;&#1085;&#1077;&#1088;&#1072;&#1094;&#1080;&#1103; &#1101;&#1084;&#1073;&#1077;&#1076;&#1076;&#1080;&#1085;&#1075;&#1086;&#1074;]</text><g class="message" data-participant-1="Worker" data-participant-2="EMB"><polygon fill="#000000" points="1095.21,409.3672,1105.21,413.3672,1095.21,417.3672,1099.21,413.3672" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="929.0698" x2="1101.21" y1="413.3672" y2="413.3672"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="154.1401" x="936.0698" y="408.3013">embed_chunks(chunks)</text></g><g class="message" data-participant-1="EMB" data-participant-2="Worker"><polygon fill="#000000" points="940.0698,438.5,930.0698,442.5,940.0698,446.5,936.0698,442.5" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="934.0698" x2="1106.21" y1="442.5" y2="442.5"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="48.0073" x="946.0698" y="437.4341">vectors</text></g><g class="message" data-participant-1="Worker" data-participant-2="VDB"><polygon fill="#000000" points="1242.2754,467.6328,1252.2754,471.6328,1242.2754,475.6328,1246.2754,471.6328" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="929.0698" x2="1248.2754" y1="471.6328" y2="471.6328"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="99.855" x="936.0698" y="466.5669">upsert(vectors)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="876.7495" x2="1453.0391" y1="480.6328" y2="480.6328"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="132.9883" x="881.7495" y="490.8433">[&#1048;&#1085;&#1076;&#1077;&#1082;&#1089;&#1072;&#1094;&#1080;&#1103; &#1090;&#1077;&#1082;&#1089;&#1090;&#1072;]</text><g class="message" data-participant-1="Worker" data-participant-2="ES"><polygon fill="#000000" points="1367.7905,511.5703,1377.7905,515.5703,1367.7905,519.5703,1371.7905,515.5703" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="929.0698" x2="1373.7905" y1="515.5703" y2="515.5703"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="177.1567" x="936.0698" y="510.5044">index_text_chunks(chunks)</text></g><g class="message" data-participant-1="Worker" data-participant-2="DB"><polygon fill="#000000" points="667.9121,547.7031,657.9121,551.7031,667.9121,555.7031,663.9121,551.7031" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="661.9121" x2="928.0698" y1="551.7031" y2="551.7031"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="139.6484" x="673.9121" y="546.6372">update_status(ready)</text></g><g class="message" data-participant-1="Worker" data-participant-2="MQ"><polygon fill="#000000" points="793.7759,576.8359,783.7759,580.8359,793.7759,584.8359,789.7759,580.8359" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="787.7759" x2="928.0698" y1="580.8359" y2="580.8359"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="102.8384" x="799.7759" y="575.77">task_completed</text></g><!--SRC=[NL9DRzD04BtlhnXwGCa11VNe0n9LKXI9Y4Hkmj7Qs4DYnR7DxheVGaYbbJXHSU00D_v2IXg80irlMFyZPhtviks3lVlUpBnvCq_K6AS8QSJ3cAbGHGZwkvxfUNwTt-e_UgLde9UWr_e-lwRxUxtER-pjIZ_gfPxh9MCf5ohqmvJ72exqJsB_pRzGz5h_qZFYBypv2BY4Vfdx5eVGRrkaNOPUTjlmYYkyu5S5JkSoeSaL1rSbWe-mO9owPK8taMeaqEszBk3cIHa-ut82lGmp6ztfLQGbOeAYWEnl6MvDXnW4OJm25yLvwDiahKwbo01zKaYr2tXGrT2AkAIJH2xyiStWCjQ7Po_83-Tm5B_fRv7Vx6pFRrc_RNZaYmFTD-uPD7WQDeP9CcbaQPJmW1aBYN7gEY191Ng2NtZlmWYtIFF40LyWkUm9z1CHrAJYAfCEf1YRvkfRPgVd0CRlZLkrL2G-IkcPKXl2Hk_nysFueCXNBmm-CjRfcL3h7gKy2FCCYLbaAv5q15RT_duNouL4U0h-E8if62zLiNIWlz5kFP8nj9lvPxtClq9-f__HcYxq0xrB0kTc3HdGiyzBSw9-p0Yz8gMisK-zu15QjBIjVbuCKLPo38nxMIfHgDg6KMSOaKxzWye-a8HL_cclwyPUq7TMLKFTXt60bqLdLKKq2NPWYQqQc9dPOTMCSLVr7MKphM8CVZ9D8rGOiFy0]--></g></svg>