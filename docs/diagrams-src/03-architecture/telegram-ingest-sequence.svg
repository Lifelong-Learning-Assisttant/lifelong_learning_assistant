<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="636px" preserveAspectRatio="none" style="width:1289px;height:636px;background:#FFFFFF;" version="1.1" viewBox="0 0 1289 636" width="1289px" zoomAndPan="magnify"><title>Telegram ingest (background)</title><defs/><g><text fill="#000000" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="376.7178" x="460.4797" y="35.4209">Telegram ingest (background)</text><rect fill="#FFFFFF" height="267" style="stroke:#000000;stroke-width:1;" width="865.73" x="417.9473" y="316.8359"/><rect fill="#FFFFFF" height="148.4688" style="stroke:#000000;stroke-width:1;" width="522.9844" x="750.6929" y="399.2344"/><rect fill="#FFFFFF" height="43.9375" style="stroke:none;stroke-width:1;" width="522.9844" x="750.6929" y="503.7656"/><g><title>Telegram</title><rect fill="#000000" fill-opacity="0.00000" height="517.9297" width="8" x="56.2637" y="82.9063"/><line style="stroke:#000000;stroke-width:1;" x1="60" x2="60" y1="82.9063" y2="600.8359"/></g><g><title>Telegram Adapter</title><rect fill="#000000" fill-opacity="0.00000" height="517.9297" width="8" x="196.9102" y="82.9063"/><line style="stroke:#000000;stroke-width:1;" x1="200.5273" x2="200.5273" y1="82.9063" y2="600.8359"/></g><g><title>Data Storage</title><rect fill="#000000" fill-opacity="0.00000" height="517.9297" width="8" x="350.6201" y="82.9063"/><line style="stroke:#000000;stroke-width:1;" x1="354.293" x2="354.293" y1="82.9063" y2="600.8359"/></g><g><title>PostgreSQL</title><rect fill="#000000" fill-opacity="0.00000" height="517.9297" width="8" x="481.3237" y="82.9063"/><line style="stroke:#000000;stroke-width:1;" x1="484.9473" x2="484.9473" y1="82.9063" y2="600.8359"/></g><g><title>Task Queue</title><rect fill="#000000" fill-opacity="0.00000" height="517.9297" width="8" x="607.1875" y="82.9063"/><line style="stroke:#000000;stroke-width:1;" x1="610.7002" x2="610.7002" y1="82.9063" y2="600.8359"/></g><g><title>Worker</title><rect fill="#000000" fill-opacity="0.00000" height="517.9297" width="8" x="799.0132" y="82.9063"/><line style="stroke:#000000;stroke-width:1;" x1="802.6929" x2="802.6929" y1="82.9063" y2="600.8359"/></g><g><title>Vector DB</title><rect fill="#000000" fill-opacity="0.00000" height="517.9297" width="8" x="996.3843" y="82.9063"/><line style="stroke:#000000;stroke-width:1;" x1="1000.1177" x2="1000.1177" y1="82.9063" y2="600.8359"/></g><g><title>Elasticsearch</title><rect fill="#000000" fill-opacity="0.00000" height="517.9297" width="8" x="1121.8994" y="82.9063"/><line style="stroke:#000000;stroke-width:1;" x1="1125.6509" x2="1125.6509" y1="82.9063" y2="600.8359"/></g><g><title>EMB</title><rect fill="#000000" fill-opacity="0.00000" height="517.9297" width="8" x="1227.4126" y="82.9063"/><line style="stroke:#000000;stroke-width:1;" x1="1231.1479" x2="1231.1479" y1="82.9063" y2="600.8359"/></g><g class="participant participant-head" data-participant="TG"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="80.5273" x="20" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="66.5273" x="27" y="71.6045">Telegram</text></g><g class="participant participant-tail" data-participant="TG"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="80.5273" x="20" y="599.8359"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="66.5273" x="27" y="619.8311">Telegram</text></g><g class="participant participant-head" data-participant="Adapter"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="140.7656" x="130.5273" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="126.7656" x="137.5273" y="71.6045">Telegram Adapter</text></g><g class="participant participant-tail" data-participant="Adapter"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="140.7656" x="130.5273" y="599.8359"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="126.7656" x="137.5273" y="619.8311">Telegram Adapter</text></g><g class="participant participant-head" data-participant="FS"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="106.6543" x="301.293" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="92.6543" x="308.293" y="71.6045">Data Storage</text></g><g class="participant participant-tail" data-participant="FS"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="106.6543" x="301.293" y="599.8359"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="92.6543" x="308.293" y="619.8311">Data Storage</text></g><g class="participant participant-head" data-participant="DB"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="94.7529" x="437.9473" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="80.7529" x="444.9473" y="71.6045">PostgreSQL</text></g><g class="participant participant-tail" data-participant="DB"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="94.7529" x="437.9473" y="599.8359"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="80.7529" x="444.9473" y="619.8311">PostgreSQL</text></g><g class="participant participant-head" data-participant="MQ"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="96.9746" x="562.7002" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="82.9746" x="569.7002" y="71.6045">Task Queue</text></g><g class="participant participant-tail" data-participant="MQ"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="96.9746" x="562.7002" y="599.8359"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="82.9746" x="569.7002" y="619.8311">Task Queue</text></g><g class="participant participant-head" data-participant="Worker"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="64.6406" x="770.6929" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="50.6406" x="777.6929" y="71.6045">Worker</text></g><g class="participant participant-tail" data-participant="Worker"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="64.6406" x="770.6929" y="599.8359"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="50.6406" x="777.6929" y="619.8311">Worker</text></g><g class="participant participant-head" data-participant="VDB"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="84.5332" x="958.1177" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="70.5332" x="965.1177" y="71.6045">Vector DB</text></g><g class="participant participant-tail" data-participant="VDB"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="84.5332" x="958.1177" y="599.8359"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="70.5332" x="965.1177" y="619.8311">Vector DB</text></g><g class="participant participant-head" data-participant="ES"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="106.4971" x="1072.6509" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="92.4971" x="1079.6509" y="71.6045">Elasticsearch</text></g><g class="participant participant-tail" data-participant="ES"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="106.4971" x="1072.6509" y="599.8359"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="92.4971" x="1079.6509" y="619.8311">Elasticsearch</text></g><g class="participant participant-head" data-participant="EMB"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="44.5293" x="1209.1479" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="30.5293" x="1216.1479" y="71.6045">EMB</text></g><g class="participant participant-tail" data-participant="EMB"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="44.5293" x="1209.1479" y="599.8359"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="30.5293" x="1216.1479" y="619.8311">EMB</text></g><g class="message" data-participant-1="TG" data-participant-2="Adapter"><polygon fill="#000000" points="188.9102,110.0391,198.9102,114.0391,188.9102,118.0391,192.9102,114.0391" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="60.2637" x2="194.9102" y1="114.0391" y2="114.0391"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="91.7935" x="67.2637" y="108.9731">new_message</text></g><g class="message" data-participant-1="Adapter" data-participant-2="FS"><polygon fill="#000000" points="342.6201,139.1719,352.6201,143.1719,342.6201,147.1719,346.6201,143.1719" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="200.9102" x2="348.6201" y1="143.1719" y2="143.1719"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="125.7979" x="207.9102" y="138.106">save_raw_message</text></g><g class="message" data-participant-1="Adapter" data-participant-2="DB"><polygon fill="#000000" points="473.3237,168.3047,483.3237,172.3047,473.3237,176.3047,477.3237,172.3047" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="200.9102" x2="479.3237" y1="172.3047" y2="172.3047"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="211.3833" x="207.9102" y="167.2388">save_metadata(status: pending)</text></g><g class="message" data-participant-1="Adapter" data-participant-2="MQ"><polygon fill="#000000" points="599.1875,197.4375,609.1875,201.4375,599.1875,205.4375,603.1875,201.4375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="200.9102" x2="605.1875" y1="201.4375" y2="201.4375"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="182.2729" x="207.9102" y="196.3716">enqueue(process_message)</text></g><g class="message" data-participant-1="MQ" data-participant-2="Worker"><polygon fill="#000000" points="791.0132,226.5703,801.0132,230.5703,791.0132,234.5703,795.0132,230.5703" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="611.1875" x2="797.0132" y1="230.5703" y2="230.5703"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="149.0303" x="618.1875" y="225.5044">process_message_task</text></g><g class="message" data-participant-1="Worker" data-participant-2="Worker"><line style="stroke:#000000;stroke-width:1;" x1="803.0132" x2="845.0132" y1="259.7031" y2="259.7031"/><line style="stroke:#000000;stroke-width:1;" x1="845.0132" x2="845.0132" y1="259.7031" y2="272.7031"/><line style="stroke:#000000;stroke-width:1;" x1="804.0132" x2="845.0132" y1="272.7031" y2="272.7031"/><polygon fill="#000000" points="814.0132,268.7031,804.0132,272.7031,814.0132,276.7031,810.0132,272.7031" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="183.3711" x="810.0132" y="254.6372">extract_text &amp; tag_message</text></g><g class="message" data-participant-1="Worker" data-participant-2="DB"><polygon fill="#000000" points="496.3237,297.8359,486.3237,301.8359,496.3237,305.8359,492.3237,301.8359" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="490.3237" x2="802.0132" y1="301.8359" y2="301.8359"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="172.9292" x="502.3237" y="296.77">save_processed_metadata</text></g><path d="M417.9473,316.8359 L482.3901,316.8359 L482.3901,323.9688 L472.3901,333.9688 L417.9473,333.9688 L417.9473,316.8359" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="267" style="stroke:#000000;stroke-width:1;" width="865.73" x="417.9473" y="316.8359"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="432.9473" y="329.9028">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="193.585" x="497.3901" y="329.0464">[&#1045;&#1089;&#1083;&#1080; &#1089;&#1086;&#1086;&#1073;&#1097;&#1077;&#1085;&#1080;&#1077; &#1088;&#1077;&#1083;&#1077;&#1074;&#1072;&#1085;&#1090;&#1085;&#1086;]</text><g class="message" data-participant-1="Worker" data-participant-2="MQ"><polygon fill="#000000" points="622.1875,351.1016,612.1875,355.1016,622.1875,359.1016,618.1875,355.1016" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="616.1875" x2="802.0132" y1="355.1016" y2="355.1016"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="167.8257" x="628.1875" y="350.0356">enqueue(index_message)</text></g><g class="message" data-participant-1="MQ" data-participant-2="Worker"><polygon fill="#000000" points="791.0132,380.2344,801.0132,384.2344,791.0132,388.2344,795.0132,384.2344" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="611.1875" x2="797.0132" y1="384.2344" y2="384.2344"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="69.6592" x="618.1875" y="379.1685">index_task</text></g><path d="M750.6929,399.2344 L820.1821,399.2344 L820.1821,406.3672 L810.1821,416.3672 L750.6929,416.3672 L750.6929,399.2344" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="148.4688" style="stroke:#000000;stroke-width:1;" width="522.9844" x="750.6929" y="399.2344"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24.4893" x="765.6929" y="412.3013">par</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="157.5664" x="835.1821" y="411.4448">[&#1057;&#1077;&#1084;&#1072;&#1085;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;&#1081; &#1080;&#1085;&#1076;&#1077;&#1082;&#1089;]</text><g class="message" data-participant-1="Worker" data-participant-2="EMB"><polygon fill="#000000" points="1219.4126,433.5,1229.4126,437.5,1219.4126,441.5,1223.4126,437.5" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="803.0132" x2="1225.4126" y1="437.5" y2="437.5"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="110.0874" x="810.0132" y="432.4341">embed_message</text></g><g class="message" data-participant-1="EMB" data-participant-2="Worker"><polygon fill="#000000" points="814.0132,462.6328,804.0132,466.6328,814.0132,470.6328,810.0132,466.6328" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="808.0132" x2="1230.4126" y1="466.6328" y2="466.6328"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="41.2344" x="820.0132" y="461.5669">vector</text></g><g class="message" data-participant-1="Worker" data-participant-2="VDB"><polygon fill="#000000" points="988.3843,491.7656,998.3843,495.7656,988.3843,499.7656,992.3843,495.7656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="803.0132" x2="994.3843" y1="495.7656" y2="495.7656"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="93.082" x="810.0132" y="490.6997">upsert(vector)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="750.6929" x2="1273.6772" y1="504.7656" y2="504.7656"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="165.8701" x="755.6929" y="514.9761">[&#1055;&#1086;&#1083;&#1085;&#1086;&#1090;&#1077;&#1082;&#1089;&#1090;&#1086;&#1074;&#1099;&#1081; &#1080;&#1085;&#1076;&#1077;&#1082;&#1089;]</text><g class="message" data-participant-1="Worker" data-participant-2="ES"><polygon fill="#000000" points="1113.8994,535.7031,1123.8994,539.7031,1113.8994,543.7031,1117.8994,539.7031" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="803.0132" x2="1119.8994" y1="539.7031" y2="539.7031"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="133.104" x="810.0132" y="534.6372">index_message_text</text></g><g class="message" data-participant-1="Worker" data-participant-2="DB"><polygon fill="#000000" points="496.3237,571.8359,486.3237,575.8359,496.3237,579.8359,492.3237,575.8359" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="490.3237" x2="802.0132" y1="575.8359" y2="575.8359"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="113.2866" x="502.3237" y="570.77">mark_as_indexed</text></g><!--SRC=[ZLBDRjD04BxlKmmzeFJG5yW1YIffBqJ2SXIErjGUkLRyn-wuz4Yv8CIPC-8De29IQ4YUOVr6ZDTs4bSvOClhyNxVpdpVZ5_mBMK4POf9hZZXb61EASKQCqZoc0p3w0R3PQoBAe_EbIfHSn8c9UOCPptr3D30_Feq2AyZB9cq8tNna3b1Hl2vq1YJOrtvGyBRmd2ioVVUE7Xo-QmIcYLu5LNjwPatXDyLUjcLRyCXlA1GIajInrWyJpvDqSYN8TJXhQDCVQNcrt3ngdSpXfm-11aP8mPKjzdWL_uO3DvHeF4aFhdiy8mO8-d2o31oPSPGKXv9_y-FsJDl39I_RtoEIbs4agzFAeEPUGsdDIZdXtZ0qYBLWiSqkcUD8GSi0Rm4ndWlyq3Ug-oIKhJNgnIc3FPR_M0tTWtosidzg_vYLtPhrtO5zKS9D_8ysfzsMt-IxPq2kGxvZtqbUKJt1rSDSMYi9JWx3UWMcHVO7rBZRrTZNN-sAn7p91B-W2nR-rlWf_h1yOVbfpFnHzcDizLwxqa2mSLHyJltgvp8iMXwL9M6D8zQKgkTKaDWlqjFDernaUPKo7jd7-kl_o7Exotl9ocZQdFdqQ45msbbg9S1ci2Tf4Wrr7y0]--></g></svg>